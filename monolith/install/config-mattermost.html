


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-67846571-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuring Mattermost &mdash; Mattermost 3.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
  

  
    <link rel="top" title="Mattermost 3.5 documentation" href="../index.html"/>
        <link rel="up" title="Mattermost Administrator’s Guide" href="../guides/administrator.html"/>
        <link rel="next" title="Administrator Tasks" href="../deployment/on-boarding.html"/>
        <link rel="prev" title="Desktop Application Install Guides" href="desktop.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Mattermost
          

          
          </a>

          
            
            
              <div class="version">
                3.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/user.html">User&#8217;s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guides/administrator.html">Administrator&#8217;s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#installing-mattermost">Installing Mattermost</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../guides/administrator.html#configuring-mattermost">Configuring Mattermost</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Configuring Mattermost</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuring-mattermost-server">Configuring Mattermost Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-tls-on-the-mattermost-server">Configuring TLS on the Mattermost Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-nginx-with-ssl-and-http-2">Configuring NGINX with SSL and HTTP/2</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#deployment">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#administration">Administration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/integration.html">Integration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/developer.html">Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/core.html">Core Team Handbook</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Mattermost</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../guides/administrator.html">Mattermost Administrator&#8217;s Guide</a> &raquo;</li>
      
    <li>Configuring Mattermost</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/mattermost/docs/blob/master/source/install/config-mattermost.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuring-mattermost">
<h1>Configuring Mattermost<a class="headerlink" href="#configuring-mattermost" title="Permalink to this headline">¶</a></h1>
<p>Laboris laboris cillum aute commodo et ea duis magna pariatur sint do aliquip ipsum aute ullamco sit do.</p>
<p>Et eu adipisicing proident adipisicing voluptate exercitation irure ipsum. Sint laborum enim mollit deserunt eu consequat eiusmod. Dolor reprehenderit voluptate labore elit laborum aliquip do qui nostrud sint cillum dolore do consectetur proident nulla voluptate. Duis id nisi esse incididunt et id ea elit exercitation.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#configuring-mattermost-server" id="id1">Configuring Mattermost Server</a></li>
<li><a class="reference internal" href="#configuring-tls-on-the-mattermost-server" id="id2">Configuring TLS on the Mattermost Server</a><ul>
<li><a class="reference internal" href="#automatic-certificate-retrieval" id="id3">Automatic Certificate Retrieval</a></li>
<li><a class="reference internal" href="#manual-certificate-specification" id="id4">Manual Certificate Specification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-nginx-with-ssl-and-http-2" id="id5">Configuring NGINX with SSL and HTTP/2</a><ul>
<li><a class="reference internal" href="#setup-http2" id="id6">Setup HTTP2</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuring-mattermost-server">
<h2><a class="toc-backref" href="#contents">Configuring Mattermost Server</a><a class="headerlink" href="#configuring-mattermost-server" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Navigate to <code class="docutils literal"><span class="pre">https://mattermost.example.com</span></code> and create a team and
user.</li>
<li>The first user in the system is automatically granted the
<code class="docutils literal"><span class="pre">system_admin</span></code> role, which gives you access to the System Console.</li>
<li>From the <code class="docutils literal"><span class="pre">town-square</span></code> channel click the dropdown and choose the
<code class="docutils literal"><span class="pre">System</span> <span class="pre">Console</span></code> option</li>
<li>Update <strong>Notification</strong> &gt; <strong>Email</strong> settings to setup an SMTP email service. The example below assumes AmazonSES.</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Set <em>Send Email Notifications</em> to <code class="docutils literal"><span class="pre">true</span></code></li>
<li>Set <em>Require Email Verification</em> to <code class="docutils literal"><span class="pre">true</span></code></li>
<li>Set <em>Feedback Name</em> to <code class="docutils literal"><span class="pre">No-Reply</span></code></li>
<li>Set <em>Feedback Email</em> to <code class="docutils literal"><span class="pre">mattermost&#64;example.com</span></code></li>
<li>Set <em>SMTP Username</em> to <code class="docutils literal"><span class="pre">[YOUR_SMTP_USERNAME]</span></code></li>
<li>Set <em>SMTP Password</em> to <code class="docutils literal"><span class="pre">[YOUR_SMTP_PASSWORD]</span></code></li>
<li>Set <em>SMTP Server</em> to <code class="docutils literal"><span class="pre">email-smtp.us-east-1.amazonaws.com</span></code></li>
<li>Set <em>SMTP Port</em> to <code class="docutils literal"><span class="pre">465</span></code></li>
<li>Set <em>Connection Security</em> to <code class="docutils literal"><span class="pre">TLS</span></code></li>
<li>Save the Settings</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li>Update <strong>File</strong> &gt; <strong>Storage</strong> settings:<ul>
<li>Change <em>Local Directory Location</em> from <code class="docutils literal"><span class="pre">./data/</span></code> to
<code class="docutils literal"><span class="pre">/mattermost/data</span></code></li>
</ul>
</li>
<li>Update <strong>General</strong> &gt; <strong>Logging</strong> settings:<ul>
<li>Set <em>Log to The Console</em> to <code class="docutils literal"><span class="pre">false</span></code></li>
</ul>
</li>
<li>Feel free to modify other settings.</li>
<li>Restart the Mattermost Service by typing:<ul>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">restart</span> <span class="pre">mattermost</span></code></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="configuring-tls-on-the-mattermost-server">
<h2><a class="toc-backref" href="#contents">Configuring TLS on the Mattermost Server</a><a class="headerlink" href="#configuring-tls-on-the-mattermost-server" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Go to the <strong>General</strong> &gt; <strong>Configuration</strong> section of the System Console.</li>
<li>Change the <strong>Listen Address</strong> setting to <code class="docutils literal"><span class="pre">:443</span></code></li>
<li>Change the <strong>Connection Security</strong> setting to <code class="docutils literal"><span class="pre">TLS</span></code></li>
<li>Change the <strong>Forward port 80 to 443</strong> setting to <code class="docutils literal"><span class="pre">true</span></code> if you wish to redirect users that try to connect insecurely to a secure connection. If you&#8217;re using a proxy such as NGINX in front of Mattermost this setting is unnecessary and should be set to <code class="docutils literal"><span class="pre">false</span></code></li>
<li>Run <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">setcap</span> <span class="pre">cap_net_bind_service=+ep</span> <span class="pre">./bin/platform</span></code> in your Mattermost directory to allow Mattermost to bind to low ports. You will need to re-run this command every time you upgrade Mattermost or it will fail to bind to the port.</li>
</ol>
<p>At this point you have two options: automatic certificate retrieval though Let&#8217;s Encrypt or manually specifying a certificate.</p>
<div class="section" id="automatic-certificate-retrieval">
<h3><a class="toc-backref" href="#contents">Automatic Certificate Retrieval</a><a class="headerlink" href="#automatic-certificate-retrieval" title="Permalink to this headline">¶</a></h3>
<p>In this mode a certificate will be automatically retrieved the first time a client tries to connect to the Mattermost server. Certificates will be retrieved for any hostname a client tries to reach the server at. Setting this up is only one step:</p>
<ol class="arabic simple">
<li>Change the <strong>Use Let&#8217;s Encrypt</strong> setting to <code class="docutils literal"><span class="pre">true</span></code>.</li>
<li>Restart the Mattermost server for these changes to take effect.</li>
</ol>
</div>
<div class="section" id="manual-certificate-specification">
<h3><a class="toc-backref" href="#contents">Manual Certificate Specification</a><a class="headerlink" href="#manual-certificate-specification" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Change the <strong>Use Let&#8217;s Encrypt</strong> setting to <code class="docutils literal"><span class="pre">false</span></code>.</li>
<li>Change the <strong>TLS Certificate File</strong> setting to the location of the certificate file.</li>
<li>Change the <strong>TLS Key File</strong> setting to the location of the private key file.</li>
<li>Restart the Mattermost server for these changes to take effect.</li>
</ol>
</div>
</div>
<div class="section" id="configuring-nginx-with-ssl-and-http-2">
<h2><a class="toc-backref" href="#contents">Configuring NGINX with SSL and HTTP/2</a><a class="headerlink" href="#configuring-nginx-with-ssl-and-http-2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>You can use a free and an open certificate security like let&#8217;s
encrypt, this is how to proceed</li>
</ol>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">git</span></code></li>
<li><code class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/letsencrypt/letsencrypt</span></code></li>
<li><code class="docutils literal"><span class="pre">cd</span> <span class="pre">letsencrypt</span></code></li>
</ul>
<ol class="arabic simple" start="2">
<li>Be sure that the port 80 is not use by stopping NGINX</li>
</ol>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">nginx</span> <span class="pre">stop</span></code></li>
<li><code class="docutils literal"><span class="pre">netstat</span> <span class="pre">-na</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">':80.*LISTEN'</span></code></li>
<li><code class="docutils literal"><span class="pre">./letsencrypt-auto</span> <span class="pre">certonly</span> <span class="pre">--standalone</span></code></li>
</ul>
<ol class="arabic simple" start="3">
<li>This command will download packages and run the instance, after that
you will have to give your domain name</li>
<li>You can find your certificate in <code class="docutils literal"><span class="pre">/etc/letsencrypt/live</span></code></li>
<li>Modify the file at <code class="docutils literal"><span class="pre">/etc/nginx/sites-available/mattermost</span></code> and add
the following lines:</li>
</ol>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>upstream backend {
    server 10.10.10.2:8065;
}

server {
   listen         80;
   server_name    mattermost.example.com;
   return         301 https://$server_name$request_uri;
}

proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=mattermost_cache:10m max_size=3g inactive=120m use_temp_path=off;

server {
   listen 443 ssl;
   server_name mattermost.example.com;

   ssl on;
   ssl_certificate /etc/letsencrypt/live/yourdomainname/fullchain.pem;
   ssl_certificate_key /etc/letsencrypt/live/yourdomainname/privkey.pem;
   ssl_session_timeout 5m;
   ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
   ssl_ciphers &#39;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&#39;;
   ssl_prefer_server_ciphers on;
   ssl_session_cache shared:SSL:10m;

   location /api/v3/users/websocket {
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection &quot;upgrade&quot;;
      proxy_set_header X-Forwarded-Ssl on;
      client_max_body_size 50M;
      proxy_set_header Host $http_host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header X-Frame-Options SAMEORIGIN;
      proxy_buffers 256 16k;
      proxy_buffer_size 16k;
      proxy_read_timeout 600s;
      proxy_pass http://backend;
   }

   location / {
      proxy_set_header X-Forwarded-Ssl on;
      client_max_body_size 50M;
      proxy_set_header Connection &quot;&quot;;
      proxy_set_header Host $http_host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header X-Frame-Options SAMEORIGIN;
      proxy_buffers 256 16k;
      proxy_buffer_size 16k;
      proxy_read_timeout 600s;
      proxy_cache mattermost_cache;
      proxy_cache_revalidate on;
      proxy_cache_min_uses 2;
      proxy_cache_use_stale timeout;
      proxy_cache_lock on;
      proxy_pass http://backend;
    }
}
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>Be sure to restart NGINX</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">\</span> <span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">nginx</span> <span class="pre">start</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="7">
<li>Add the following line to cron so the cert will renew every month</li>
</ol>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">crontab</span> <span class="pre">-e</span></code></li>
<li><code class="docutils literal"><span class="pre">&#64;monthly</span> <span class="pre">/home/ubuntu/letsencrypt/letsencrypt-auto</span> <span class="pre">certonly</span> <span class="pre">--reinstall</span> <span class="pre">--nginx</span> <span class="pre">-d</span> <span class="pre">yourdomainname</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">nginx</span> <span class="pre">reload</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="8">
<li>Check that your SSL certificate is set up correctly</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Test the SSL certificate by visiting a site such as <a class="reference external" href="https://www.ssllabs.com/ssltest/index.html">https://www.ssllabs.com/ssltest/index.html</a></li>
<li>If there’s an error about the missing chain or certificate path, there is likely an intermediate certificate missing that needs to be included</li>
</ul>
</div></blockquote>
<div class="section" id="setup-http2">
<h3><a class="toc-backref" href="#contents">Setup HTTP2</a><a class="headerlink" href="#setup-http2" title="Permalink to this headline">¶</a></h3>
<p>It is recommended to enable HTTP2 for enhanced performance.</p>
<ol class="arabic simple">
<li>Modify your NGINX configuration as above. Then,</li>
</ol>
<blockquote>
<div><ul class="simple">
<li>Change the line <code class="docutils literal"><span class="pre">listen</span> <span class="pre">443</span> <span class="pre">ssl;</span></code> to <code class="docutils literal"><span class="pre">listen</span> <span class="pre">443</span> <span class="pre">ssl</span> <span class="pre">http2;</span></code></li>
<li>Change the line <code class="docutils literal"><span class="pre">proxy_pass</span> <span class="pre">http://10.10.10.2:8065;</span></code> to <code class="docutils literal"><span class="pre">proxy_pass</span> <span class="pre">https://10.10.10.2:8065;</span></code></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Restart NGINX</li>
</ol>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../deployment/on-boarding.html" class="btn btn-neutral float-right" title="Administrator Tasks" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="desktop.html" class="btn btn-neutral" title="Desktop Application Install Guides" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016 Mattermost.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
 




<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-cog">&nbsp;&nbsp;Options</span>&nbsp;
        <span class="fa fa-angle-up"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Contribute</dt>
            <dd>
                <a href="https://github.com/mattermost/docs/issues">Report a Problem</a>
            </dd>
            
            <dd>
                <a href="https://github.com/mattermost/docs/blob/master/source/install/config-mattermost.rst"> Edit on GitHub</a>
            </dd>
            
        </dl>
    </div>
</div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/myscript.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
	<header>
	<div class="header__container">
		<a href="http://docs.mattermost.com/" class="header__logo">
			<img width="176" src="https://about.mattermost.com/wp-content/uploads/2016/01/logo.png">
		</a>
		<div class="links__icon">
			<i class="fa fa-bars"></i>
		</div>
		<ul class="header__links">
			<li><a href="https://about.mattermost.com/solutions/">Solutions</a></li>
			<li><a href="https://about.mattermost.com/features/">Features</a></li>
			<li><a class="active" href="http://docs.mattermost.com/">Documentation</a></li>
			<li><a href="https://about.mattermost.com/pricing/">Pricing</a></li>
			<li><a href="https://about.mattermost.com/contact/">Contact</a></li>
			<li><a href="https://www.mattermost.org/download/">Download</a></li>
		</ul>
	</div>
</header>


</body>
</html>